version: '3'

services:
  server:
    image: jpetazzo/dockvpn
    container_name: vpn
    restart: always
    privileged: true
    volumes:
      - openvpn:/etc/openvpn
      - ./run:/usr/local/sbin/run
      - ./serveconfig:/usr/local/sbin/serveconfig
    ports:
      - 1194:1194/udp
      - 8080:443/tcp

  config:
    image: jpetazzo/dockvpn
    container_name: vpn-config
    restart: always
    command: serveconfig
    volumes:
      - openvpn:/etc/openvpn
      - ./run:/usr/local/sbin/run
      - ./serveconfig:/usr/local/sbin/serveconfig
    labels:
      - traefik.enable=true
      - traefik.port=8080
      - traefik.protocol=https
      - traefik.frontend.rule=Host:${traefik_url}
      - traefik.frontend.auth.basic=${traefik_auth}
      - traefik.home=true
      - traefik.home.alias=Vpn
      - traefik.home.image=logos/vpn.png
      - traefik.home.category=Tools

volumes:
  openvpn:
    driver: "local"
